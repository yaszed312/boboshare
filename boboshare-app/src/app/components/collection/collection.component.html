<div class="collection-container">
  <div class="collection-header">
    <h2>Create Collections</h2>
    <p>Group your media files and share them with a single URL</p>
  </div>

  <!-- Create New Collection -->
  <div class="create-collection-section">
    <div class="section-header">
      <h3>Create New Collection</h3>
    </div>
    <div class="create-form">
      <div class="form-group">
        <label for="collectionName">Collection Name</label>
        <input type="text" 
               id="collectionName" 
               [(ngModel)]="newCollectionName" 
               placeholder="Enter collection name"
               class="form-input">
      </div>
      <div class="form-group">
        <label for="collectionDescription">Description (Optional)</label>
        <textarea id="collectionDescription" 
                  [(ngModel)]="newCollectionDescription" 
                  placeholder="Describe your collection"
                  class="form-textarea"></textarea>
      </div>
      <button class="create-btn" 
              [disabled]="!newCollectionName.trim()" 
              (click)="createCollection()">
        Create Collection
      </button>
    </div>
  </div>

  <!-- Collections List -->
  <div class="collections-section" *ngIf="collections.length">
    <div class="section-header">
      <h3>Your Collections</h3>
    </div>
    
    <div class="collections-grid">
      <div class="collection-card" *ngFor="let collection of collections">
        <div class="collection-header-card">
          <div class="collection-info">
            <h4>{{ collection.name }}</h4>
            <p *ngIf="collection.description">{{ collection.description }}</p>
            <p class="collection-meta">
              {{ collection.files.length }} files • 
              {{ formatDate(collection.updatedAt) }}
            </p>
          </div>
          <div class="collection-actions">
            <button class="action-btn share-btn" 
                    (click)="shareCollection(collection)"
                    title="Share Collection">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M18 8C19.6569 8 21 6.65685 21 5C21 3.34315 19.6569 2 18 2C16.3431 2 15 3.34315 15 5C15 5.12548 15.0077 5.24917 15.0227 5.37061L8.08264 9.26727C7.54305 8.48822 6.61644 8 5.5 8C4.11929 8 3 9.11929 3 10.5C3 11.8807 4.11929 13 5.5 13C6.61644 13 7.54305 12.5118 8.08264 11.7327L15.0227 15.6294C15.0077 15.7508 15 15.8745 15 16C15 17.6569 16.3431 19 18 19C19.6569 19 21 17.6569 21 16C21 14.3431 19.6569 13 18 13C16.8836 13 15.957 13.4882 15.4174 14.2673L8.47736 10.3706C8.49232 10.2492 8.5 10.1255 8.5 10C8.5 9.87452 8.49232 9.75083 8.47736 9.62939L15.4174 5.73273C15.957 6.51178 16.8836 7 18 7Z" fill="currentColor"/>
              </svg>
            </button>
            <button class="action-btn edit-btn" 
                    (click)="editCollection(collection)"
                    title="Edit Collection">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
            <button class="action-btn delete-btn" 
                    (click)="deleteCollection(collection)"
                    title="Delete Collection">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </button>
          </div>
        </div>
        
        <div class="collection-files" *ngIf="collection.files.length">
          <div class="files-grid">
            <div class="file-thumbnail" *ngFor="let file of collection.files.slice(0, 6)">
              <img *ngIf="file.type === 'image' || file.type.startsWith('image/')"
                   [src]="file.url" 
                   [alt]="file.name"
                   class="file-preview">
              <video *ngIf="file.type === 'video' || file.type.startsWith('video/')"
                     [src]="file.url" 
                     class="file-preview" 
                     muted>
              </video>
            </div>
            <div class="more-files" *ngIf="collection.files.length > 6">
              <span>+{{ collection.files.length - 6 }} more</span>
            </div>
          </div>
        </div>
        
        <div class="collection-empty" *ngIf="!collection.files.length">
          <p>No files in this collection yet</p>
          <button class="add-files-btn" (click)="addFilesToCollection(collection)">
            Add Files
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!collections.length">
    <div class="empty-icon">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
    <h3>No Collections Yet</h3>
    <p>Create your first collection to start grouping and sharing your media files</p>
  </div>

  <!-- Share Modal -->
  <div class="modal-overlay" *ngIf="showShareModal" (click)="closeShareModal()">
    <div class="share-modal" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Share Collection</h3>
        <button class="close-btn" (click)="closeShareModal()">×</button>
      </div>
      <div class="modal-content">
        <div class="collection-preview">
          <h4>{{ selectedCollection?.name }}</h4>
          <p *ngIf="selectedCollection?.description">{{ selectedCollection?.description }}</p>
          <div class="preview-files">
            <div class="preview-file" *ngFor="let file of selectedCollection?.files?.slice(0, 4) || []">
              <img *ngIf="file.type === 'image' || file.type.startsWith('image/')" 
                   [src]="file.url" 
                   [alt]="file.name">
              <video *ngIf="file.type === 'video' || file.type.startsWith('video/')" 
                     [src]="file.url" 
                     muted>
              </video>
            </div>
            <div class="more-preview" *ngIf="(selectedCollection?.files?.length || 0) > 4">
              <span>+{{ (selectedCollection?.files?.length || 0) - 4 }} more</span>
            </div>
          </div>
        </div>
        <div class="share-info">
          <div class="share-url-container">
            <input type="text" 
                   [value]="selectedCollection?.shareUrl" 
                   readonly 
                   class="share-url-input">
            <button class="copy-url-btn" (click)="copyShareUrl()">Copy</button>
          </div>
          <div class="share-options">
            <button class="social-btn facebook-btn" (click)="shareToFacebook()">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
              </svg>
              Facebook
            </button>
            <button class="social-btn twitter-btn" (click)="shareToTwitter()">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
              </svg>
              Twitter
            </button>
            <button class="social-btn whatsapp-btn" (click)="shareToWhatsApp()">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
              </svg>
              WhatsApp
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
